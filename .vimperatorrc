" Delete all bookmarks when starting up (because I'll manage them manually).
javascript <<EOF
var bms = services.get("bookmarks");
bms.removeFolderChildren(bms.bookmarksMenuFolder);
bms.removeFolderChildren(bms.toolbarFolder);
bms.removeFolderChildren(bms.unfiledBookmarksFolder);
EOF

" Delete all search engines when starting up. Add my favorite ones.
javascript <<EOF
var bss = services.get("browserSearch");
bss.getEngines({}).forEach(function (engine) { bss.removeEngine(engine); });
var myengines = [ ["Google",
                   "http://www.google.com/favicon.ico",
                   "g",
                   "Google Web Search",
                   "GET",
                   "http://www.google.com/search?q={searchTerms}",
                  ],
                  ["Google Code",
                   "http://www.google.com/favicon.ico",
                   "gc",
                   "Google Code Search",
                   "GET",
                   "http://www.google.com/codesearch?q={searchTerms}",
                  ],
                  ["Ixquick",
                   "http://www.ixquick.com/favicon.ico",
                   "i",
                   "Ixquick Web Search",
                   "GET",
                   "https://s4-eu.ixquick.com/do/metasearch.pl?prf=f5253fd910e2393ad4ab017fd499462f&query={searchTerms}",
                  ],
                  ["Scroogle",
                   "http://www.scroogle.org/favicon.ico",
                   "s",
                   "Scroogle Web Search",
                   "GET",
                   "https://ssl.scroogle.org/cgi-bin/nbbwssl.cgi?Gw={searchTerms}&n=5",
                  ],
                  ["Twitter",
                   "http://search.twitter.com/favicon.png",
                   "t",
                   "Twitter Search",
                   "GET",
                   "http://search.twitter.com/search?q={searchTerms}",
                  ],
                  ["MozillaZine KB",
                   "http://kb.mozillazine.org/favicon.ico",
                   "mozkb",
                   "MozillaZine Knowledge Base Search",
                   "GET",
                   "http://kb.mozillazine.org/Special:Search?search={searchTerms}",
                  ]
                ];
// Wikipedia in several languages.
['de', 'en'].forEach(function (lang) {
	myengines.push(["Wikipedia " + lang, "http://" + lang + ".wikipedia.org/favicon.ico", "w" + lang, "Wikipedia " + lang, "GET", "http://" + lang + ".wikipedia.org/wiki/Special:Search?search={searchTerms}"]);
});
myengines.forEach(function (engine) {
	bss.addEngineWithDetails(engine[0] + " (Scytale)", engine[1], engine[2], engine[3], engine[4], engine[5]);
});
bss.defaultEngine = bss.getEngineByName(myengines[0][0] + " (Scytale)")
EOF

" Set the default engine.
set defsearch="g"

" A builtin is.gd shortener.
javascript <<EOF
shortenURLIsGd = function (url) {
	var req = new XMLHttpRequest();
	req.open("GET", "http://is.gd/api.php?longurl=" + escape(url), true)
	req.onreadystatechange = function (ev) {
		if (req.readyState == 4) {
			if (req.status == 200) {
				util.copyToClipboard(req.responseText, true);
			} else {
				liberator.echo(req.responseText);
			}
		}
	}
	req.send(null);
}
EOF
map <silent> gy :javascript shortenURLIsGd(buffer.URL);<CR>

" Don't warn on about:config.
set! general.warnOnAboutConfig=false

" No close buttons on tabs.
set! browser.tabs.closeButtons=2

" Always display tabs bar.
set! browser.tabs.autoHide=false

" Allow for smaller and wider tabs.
set! browser.tabs.tabMinWidth=50
set! browser.tabs.tabMaxWidth=4000

" Open in new tabs instead of new windows. Always.
set! browser.link.open_newwindow=3
set! browser.link.open_newwindow.restriction=0

" No automatic update checks.
set! app.update.enabled=false
set! browser.search.update=false
set! extensions.update.enabled=false
set! extensions.update.notifyUser=false

" No prefetching.
set! network.prefetch-next=false

" Empty start page.
set! browser.startup.

" Make backspace go back, control-backspace go forward.
map <BS> :back<CR>
map <C-BS> :forward<CR>

" Make Alt-O and Alt-T do default searches.
execute "map <A-o> :open " + options.defsearch + " "
execute "map <A-t> :tabopen " + options.defsearch + " "

" Show a tab number over the tab icon.
set guioptions=N

" Hints for input fields use their label, then their name.
set hintinputs="label,name"

" Open some things that should open in a new tab in a new tab.
set newtab="all"

" Use smart case searches.
set ignorecase smartcase

" Do not use suggest engines.
set suggestengines=""

" Complete awesomely.
set wildoptions="auto" wildmode="list:full"

" Use my own external editor and pass it the current URL.
set editor="scy-vimperator-editor ''"
autocmd LocationChange . :set editor="scy-vimperator-editor '<url>'"

" Ring a visual bell on errors.
set errorbells visualbell

" Let me manually focus input elements.
set focuscontent

" Clear the command bar.
echo
